<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width" />

    <style>
      body {
        font-family: Tahoma, Geneva, sans-serif;
      }
    </style>

    <!-- colyseus.js client -->
    <script src="https://unpkg.com/colyseus.js@^0.15.0/dist/colyseus.js"></script>
    <style type="text/css">
      .player {
        width: 100px;
        height: 100px;
        position: absolute;
        padding-top: 24px;
        box-sizing: border-box;
        left: 0;
        top: 0;
      }
      .room-list {
        list-style: none;
        padding: 0;
      }
      .room-item {
        margin: 5px 0;
        padding: 5px;
        border: 1px solid #ddd;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h2>lobby</h2>
    <ul id="roomList" class="room-list"></ul>

    <script type="module">

      var client = new Colyseus.Client("ws://localhost:2567");
      let allRooms = [];

      client.joinOrCreate("lobby").then((lobby) => {
        lobby.onMessage("rooms", (rooms) => {
          console.log("rooms", rooms);
        allRooms = rooms;
        renderRooms();
      });

      lobby.onMessage("+", ([roomId, room]) => {
        const roomIndex = allRooms.findIndex((room) => room.roomId === roomId);
        if (roomIndex !== -1) {
          allRooms[roomIndex] = room;

        } else {
          allRooms.push(room);
        }
        renderRooms();
      });

      lobby.onMessage("-", (roomId) => {
        allRooms = allRooms.filter((room) => room.roomId !== roomId);
        renderRooms();
      });
      });
      function renderRooms() {
        const roomListElement = document.getElementById('roomList');
        roomListElement.innerHTML = ''; // Clear existing room list
        allRooms.forEach((room, index) => {
          const roomItem = document.createElement('li');
          roomItem.className = 'room-item';
          roomItem.textContent = room.name; // Assuming the room object has a 'name' property
          roomItem.onclick = function() { joinRoom(room.roomId); }; // Add click event to join room
          roomListElement.appendChild(roomItem);
        });
      }
    </script>
  </body>
</html>
